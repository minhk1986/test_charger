{"remainingRequest":"/home/robotics/TungNV/agv_v2_ws/src/agv_v2/webServer/agv-dasboard/node_modules/babel-loader/lib/index.js!/home/robotics/TungNV/agv_v2_ws/src/agv_v2/webServer/agv-dasboard/node_modules/eslint-loader/index.js??ref--13-0!/home/robotics/TungNV/agv_v2_ws/src/agv_v2/webServer/agv-dasboard/src/services/agvr/agvr-action.js","dependencies":[{"path":"/home/robotics/TungNV/agv_v2_ws/src/agv_v2/webServer/agv-dasboard/src/services/agvr/agvr-action.js","mtime":1609316939488},{"path":"/home/robotics/TungNV/agv_v2_ws/src/agv_v2/webServer/agv-dasboard/node_modules/cache-loader/dist/cjs.js","mtime":1609316939616},{"path":"/home/robotics/TungNV/agv_v2_ws/src/agv_v2/webServer/agv-dasboard/node_modules/babel-loader/lib/index.js","mtime":1609316939572},{"path":"/home/robotics/TungNV/agv_v2_ws/src/agv_v2/webServer/agv-dasboard/node_modules/eslint-loader/index.js","mtime":1609316939784}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLndlYWstbWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL3JvYm90aWNzL1R1bmdOVi9hZ3ZfdjJfd3Mvc3JjL2Fndl92Mi93ZWJTZXJ2ZXIvYWd2LWRhc2JvYXJkL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvaG9tZS9yb2JvdGljcy9UdW5nTlYvYWd2X3YyX3dzL3NyYy9hZ3ZfdjIvd2ViU2VydmVyL2Fndi1kYXNib2FyZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9ob21lL3JvYm90aWNzL1R1bmdOVi9hZ3ZfdjJfd3Mvc3JjL2Fndl92Mi93ZWJTZXJ2ZXIvYWd2LWRhc2JvYXJkL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfY2xhc3NQcml2YXRlRmllbGRHZXQgZnJvbSAiL2hvbWUvcm9ib3RpY3MvVHVuZ05WL2Fndl92Ml93cy9zcmMvYWd2X3YyL3dlYlNlcnZlci9hZ3YtZGFzYm9hcmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzUHJpdmF0ZUZpZWxkR2V0IjsKaW1wb3J0IF9jbGFzc1ByaXZhdGVGaWVsZFNldCBmcm9tICIvaG9tZS9yb2JvdGljcy9UdW5nTlYvYWd2X3YyX3dzL3NyYy9hZ3ZfdjIvd2ViU2VydmVyL2Fndi1kYXNib2FyZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NQcml2YXRlRmllbGRTZXQiOwppbXBvcnQgUk9TTElCIGZyb20gInJvc2xpYiI7CmltcG9ydCAqIGFzIEFDVElPTl9TVEFUVVMgZnJvbSAnLi9hZ3YtYWN0aW9uLXN0YXR1cyc7CmltcG9ydCB7IHV1aWQgfSBmcm9tICJ2dWUtdXVpZCI7CgpmdW5jdGlvbiBzbGVlcChtcykgewogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgcmV0dXJuIHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpOwogIH0pOwp9Cgp2YXIgX2FndkFjdGlvblRvcGljID0gbmV3IFdlYWtNYXAoKTsKCnZhciBfYWd2QWN0aW9uU3RhdHVzVG9waWMgPSBuZXcgV2Vha01hcCgpOwoKdmFyIF9hY3Rpb25zID0gbmV3IFdlYWtNYXAoKTsKCnZhciBfYWN0aW9uU3RhdHVzVG9waWNSZWNlaXZlZCA9IG5ldyBXZWFrTWFwKCk7Cgp2YXIgX3B1Ymxpc2hBY3Rpb24gPSBuZXcgV2Vha01hcCgpOwoKdmFyIEFndnJBY3Rpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEFndnJBY3Rpb24ocm9zKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBZ3ZyQWN0aW9uKTsKCiAgICBfYWd2QWN0aW9uVG9waWMuc2V0KHRoaXMsIHsKICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgIHZhbHVlOiBudWxsCiAgICB9KTsKCiAgICBfYWd2QWN0aW9uU3RhdHVzVG9waWMuc2V0KHRoaXMsIHsKICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgIHZhbHVlOiBudWxsCiAgICB9KTsKCiAgICBfYWN0aW9ucy5zZXQodGhpcywgewogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgdmFsdWU6IHt9CiAgICB9KTsKCiAgICBfYWN0aW9uU3RhdHVzVG9waWNSZWNlaXZlZC5zZXQodGhpcywgewogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKG1lc3NhZ2UpIHsKICAgICAgICBfY2xhc3NQcml2YXRlRmllbGRHZXQoX3RoaXMsIF9hY3Rpb25zKVttZXNzYWdlLmFjdGlvbl9pZF0gPSBtZXNzYWdlLnN0YXR1czsKICAgICAgfQogICAgfSk7CgogICAgX3B1Ymxpc2hBY3Rpb24uc2V0KHRoaXMsIHsKICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShhY3Rpb24pIHsKICAgICAgICBpZiAoX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KF90aGlzLCBfYWd2QWN0aW9uVG9waWMpID09IG51bGwpIHJldHVybjsKICAgICAgICB2YXIgYWN0aW9uSWQgPSAiYWN0aW9uLSIuY29uY2F0KHV1aWQudjQoKSk7CgogICAgICAgIF9jbGFzc1ByaXZhdGVGaWVsZEdldChfdGhpcywgX2FndkFjdGlvblRvcGljKS5wdWJsaXNoKG5ldyBST1NMSUIuTWVzc2FnZSh7CiAgICAgICAgICBoZWFkZXI6IHsKICAgICAgICAgICAgc2VxOiAwLAogICAgICAgICAgICBzdGFtcDogMCwKICAgICAgICAgICAgZnJhbWVfaWQ6ICcnCiAgICAgICAgICB9LAogICAgICAgICAgYWN0aW9uOiBhY3Rpb24udmFsdWUsCiAgICAgICAgICBzdGF0dXM6IEFDVElPTl9TVEFUVVMuQUNUSVZFLAogICAgICAgICAgYWN0aW9uX2lkOiBhY3Rpb25JZCwKICAgICAgICAgIHR5cGU6IGFjdGlvbi50eXBlLAogICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoYWN0aW9uLmRhdGEpCiAgICAgICAgfSkpOwogICAgICB9CiAgICB9KTsKCiAgICBpZiAoIShyb3MgaW5zdGFuY2VvZiBST1NMSUIuUm9zKSkgcmV0dXJuOwoKICAgIF9jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfYWd2QWN0aW9uVG9waWMsIG5ldyBST1NMSUIuVG9waWMoewogICAgICByb3M6IHJvcywKICAgICAgbmFtZTogJy9hZ3ZfYWN0aW9uJywKICAgICAgbWVzc2FnZVR5cGU6ICdhZ3ZfZGVmaW5lL2Fndl9hY3Rpb24nCiAgICB9KSk7CgogICAgX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9hZ3ZBY3Rpb25TdGF0dXNUb3BpYywgbmV3IFJPU0xJQi5Ub3BpYyh7CiAgICAgIHJvczogcm9zLAogICAgICBuYW1lOiAnL2FjdGlvbl9zdGF0dXMnLAogICAgICBtZXNzYWdlVHlwZTogJ2Fndl9kZWZpbmUvYWd2X2FjdGlvbicKICAgIH0pKTsKCiAgICBfY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2FndkFjdGlvblN0YXR1c1RvcGljKS5zdWJzY3JpYmUoX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9hY3Rpb25TdGF0dXNUb3BpY1JlY2VpdmVkKSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQWd2ckFjdGlvbiwgW3sKICAgIGtleTogInB1c2hBY3Rpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9wdXNoQWN0aW9uID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGFjdGlvbikgewogICAgICAgIHZhciB3YWl0UmVzdWx0LAogICAgICAgICAgICBhY3Rpb25JZCwKICAgICAgICAgICAgY291bnQsCiAgICAgICAgICAgIF9hcmdzID0gYXJndW1lbnRzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHdhaXRSZXN1bHQgPSBfYXJncy5sZW5ndGggPiAxICYmIF9hcmdzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJnc1sxXSA6IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmICghKF9jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfYWd2QWN0aW9uVG9waWMpID09IG51bGwpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBBQ1RJT05fU1RBVFVTLlJFSkVDVEVEKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgYWN0aW9uSWQgPSAiYWN0aW9uLSIuY29uY2F0KHV1aWQudjQoKSk7CgogICAgICAgICAgICAgICAgaWYgKHdhaXRSZXN1bHQgPT09IHRydWUpIHsKICAgICAgICAgICAgICAgICAgX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9hY3Rpb25zKVthY3Rpb25JZF0gPSBBQ1RJT05fU1RBVFVTLlBFTkRJTkc7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9hZ3ZBY3Rpb25Ub3BpYykucHVibGlzaChuZXcgUk9TTElCLk1lc3NhZ2UoewogICAgICAgICAgICAgICAgICBoZWFkZXI6IHsKICAgICAgICAgICAgICAgICAgICBzZXE6IDAsCiAgICAgICAgICAgICAgICAgICAgc3RhbXA6IDAsCiAgICAgICAgICAgICAgICAgICAgZnJhbWVfaWQ6ICcnCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLnZhbHVlLAogICAgICAgICAgICAgICAgICBzdGF0dXM6IEFDVElPTl9TVEFUVVMuQUNUSVZFLAogICAgICAgICAgICAgICAgICBhY3Rpb25faWQ6IGFjdGlvbklkLAogICAgICAgICAgICAgICAgICB0eXBlOiBhY3Rpb24udHlwZSwKICAgICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoYWN0aW9uLmRhdGEpCiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgaWYgKCEod2FpdFJlc3VsdCA9PT0gdHJ1ZSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb3VudCA9IDA7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIGlmICghKF9jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfYWN0aW9ucylbYWN0aW9uSWRdID09PSBBQ1RJT05fU1RBVFVTLlBFTkRJTkcgJiYgY291bnQgPCAzMDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY291bnQrKzsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgIHJldHVybiBzbGVlcCg1MDApOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIGlmICghKF9jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfYWN0aW9ucylbYWN0aW9uSWRdID09PSBBQ1RJT05fU1RBVFVTLkFDVElWRSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIGlmICghKF9jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfYWN0aW9ucylbYWN0aW9uSWRdID09PSBBQ1RJT05fU1RBVFVTLkFDVElWRSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICByZXR1cm4gc2xlZXAoNTAwKTsKCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9hY3Rpb25zKVthY3Rpb25JZF0pOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHB1c2hBY3Rpb24oX3gpIHsKICAgICAgICByZXR1cm4gX3B1c2hBY3Rpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHB1c2hBY3Rpb247CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJkaXNwb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgICBfY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX2FndkFjdGlvblRvcGljLCBudWxsKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBBZ3ZyQWN0aW9uOwp9KCk7CgpleHBvcnQgeyBBZ3ZyQWN0aW9uIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["/home/robotics/TungNV/agv_v2_ws/src/agv_v2/webServer/agv-dasboard/src/services/agvr/agvr-action.js"],"names":["ROSLIB","ACTION_STATUS","uuid","sleep","ms","Promise","resolve","setTimeout","AgvrAction","ros","message","action_id","status","action","actionId","v4","publish","Message","header","seq","stamp","frame_id","value","ACTIVE","type","data","JSON","stringify","Ros","Topic","name","messageType","subscribe","waitResult","REJECTED","PENDING","count"],"mappings":"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","sourcesContent":["import ROSLIB from \"roslib\";\nimport * as ACTION_STATUS from './agv-action-status';\nimport { uuid } from \"vue-uuid\";\n\nfunction sleep(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport default class AgvrAction {\n  #agvActionTopic = null;\n  #agvActionStatusTopic = null;\n  #actions = {};\n\n  constructor(ros) {\n    if (!(ros instanceof ROSLIB.Ros)) return;\n\n    this.#agvActionTopic = new ROSLIB.Topic({\n      ros: ros,\n      name: '/agv_action',\n      messageType: 'agv_define/agv_action',\n    });\n\n    this.#agvActionStatusTopic = new ROSLIB.Topic({\n      ros: ros,\n      name: '/action_status',\n      messageType: 'agv_define/agv_action',\n    });\n\n    this.#agvActionStatusTopic.subscribe(this.#actionStatusTopicReceived);\n  }\n\n  #actionStatusTopicReceived = (message) => {\n    this.#actions[message.action_id] = message.status;\n  }\n  \n\n  async pushAction(action, waitResult = false) {\n    if (this.#agvActionTopic == null) return ACTION_STATUS.REJECTED;\n\n    let actionId = `action-${uuid.v4()}`;\n    if(waitResult === true) {\n      this.#actions[actionId] = ACTION_STATUS.PENDING;\n    }\n\n    this.#agvActionTopic.publish(new ROSLIB.Message({\n      header: { seq: 0, stamp: 0, frame_id: '', },\n      action: action.value,\n      status: ACTION_STATUS.ACTIVE,\n      action_id: actionId,\n      type: action.type,\n      data: JSON.stringify(action.data),\n    }))\n\n    if(waitResult === true) {\n      let count = 0;\n      while(this.#actions[actionId] === ACTION_STATUS.PENDING && count < 300) {\n        count++;\n        await sleep(500);\n      }\n\n      if(this.#actions[actionId] === ACTION_STATUS.ACTIVE) {\n        while(this.#actions[actionId] === ACTION_STATUS.ACTIVE) {\n          await sleep(500);\n        }\n      }\n      return this.#actions[actionId]; \n    }\n  }\n\n  #publishAction = (action) => {\n    if (this.#agvActionTopic == null) return;\n\n    let actionId = `action-${uuid.v4()}`;\n    this.#agvActionTopic.publish(new ROSLIB.Message({\n      header: { seq: 0, stamp: 0, frame_id: '', },\n      action: action.value,\n      status: ACTION_STATUS.ACTIVE,\n      action_id: actionId,\n      type: action.type,\n      data: JSON.stringify(action.data),\n    }))\n  }\n\n  dispose() {\n    this.#agvActionTopic = null;\n  }\n}"]}]}