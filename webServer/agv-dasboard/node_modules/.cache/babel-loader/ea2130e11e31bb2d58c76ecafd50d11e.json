{"remainingRequest":"/home/robotics/AnhNV/agv-dasboard/node_modules/thread-loader/dist/cjs.js!/home/robotics/AnhNV/agv-dasboard/node_modules/babel-loader/lib/index.js!/home/robotics/AnhNV/agv-dasboard/node_modules/eslint-loader/index.js??ref--13-0!/home/robotics/AnhNV/agv-dasboard/src/services/agvr/agvr-action.js","dependencies":[{"path":"/home/robotics/AnhNV/agv-dasboard/src/services/agvr/agvr-action.js","mtime":1609149483064},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/cache-loader/dist/cjs.js","mtime":1602053610278},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/thread-loader/dist/cjs.js","mtime":1602053610301},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/babel-loader/lib/index.js","mtime":1602053610019},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/eslint-loader/index.js","mtime":1602053618906}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLndlYWstbWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL3JvYm90aWNzL0FuaE5WL2Fndi1kYXNib2FyZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL2hvbWUvcm9ib3RpY3MvQW5oTlYvYWd2LWRhc2JvYXJkL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL2hvbWUvcm9ib3RpY3MvQW5oTlYvYWd2LWRhc2JvYXJkL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfY2xhc3NQcml2YXRlRmllbGRHZXQgZnJvbSAiL2hvbWUvcm9ib3RpY3MvQW5oTlYvYWd2LWRhc2JvYXJkL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc1ByaXZhdGVGaWVsZEdldCI7CmltcG9ydCBfY2xhc3NQcml2YXRlRmllbGRTZXQgZnJvbSAiL2hvbWUvcm9ib3RpY3MvQW5oTlYvYWd2LWRhc2JvYXJkL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc1ByaXZhdGVGaWVsZFNldCI7CmltcG9ydCBST1NMSUIgZnJvbSAicm9zbGliIjsKaW1wb3J0ICogYXMgQUNUSU9OX1NUQVRVUyBmcm9tICcuL2Fndi1hY3Rpb24tc3RhdHVzJzsKaW1wb3J0IHsgdXVpZCB9IGZyb20gInZ1ZS11dWlkIjsKCmZ1bmN0aW9uIHNsZWVwKG1zKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICByZXR1cm4gc2V0VGltZW91dChyZXNvbHZlLCBtcyk7CiAgfSk7Cn0KCnZhciBfYWd2QWN0aW9uVG9waWMgPSBuZXcgV2Vha01hcCgpOwoKdmFyIF9hZ3ZBY3Rpb25TdGF0dXNUb3BpYyA9IG5ldyBXZWFrTWFwKCk7Cgp2YXIgX2FjdGlvbnMgPSBuZXcgV2Vha01hcCgpOwoKdmFyIF9hY3Rpb25TdGF0dXNUb3BpY1JlY2VpdmVkID0gbmV3IFdlYWtNYXAoKTsKCnZhciBfcHVibGlzaEFjdGlvbiA9IG5ldyBXZWFrTWFwKCk7Cgp2YXIgQWd2ckFjdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQWd2ckFjdGlvbihyb3MpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFndnJBY3Rpb24pOwoKICAgIF9hZ3ZBY3Rpb25Ub3BpYy5zZXQodGhpcywgewogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgdmFsdWU6IG51bGwKICAgIH0pOwoKICAgIF9hZ3ZBY3Rpb25TdGF0dXNUb3BpYy5zZXQodGhpcywgewogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgdmFsdWU6IG51bGwKICAgIH0pOwoKICAgIF9hY3Rpb25zLnNldCh0aGlzLCB7CiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICB2YWx1ZToge30KICAgIH0pOwoKICAgIF9hY3Rpb25TdGF0dXNUb3BpY1JlY2VpdmVkLnNldCh0aGlzLCB7CiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUobWVzc2FnZSkgewogICAgICAgIF9jbGFzc1ByaXZhdGVGaWVsZEdldChfdGhpcywgX2FjdGlvbnMpW21lc3NhZ2UuYWN0aW9uX2lkXSA9IG1lc3NhZ2Uuc3RhdHVzOwogICAgICB9CiAgICB9KTsKCiAgICBfcHVibGlzaEFjdGlvbi5zZXQodGhpcywgewogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGFjdGlvbikgewogICAgICAgIGlmIChfY2xhc3NQcml2YXRlRmllbGRHZXQoX3RoaXMsIF9hZ3ZBY3Rpb25Ub3BpYykgPT0gbnVsbCkgcmV0dXJuOwogICAgICAgIHZhciBhY3Rpb25JZCA9ICJhY3Rpb24tIi5jb25jYXQodXVpZC52NCgpKTsKCiAgICAgICAgX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KF90aGlzLCBfYWd2QWN0aW9uVG9waWMpLnB1Ymxpc2gobmV3IFJPU0xJQi5NZXNzYWdlKHsKICAgICAgICAgIGhlYWRlcjogewogICAgICAgICAgICBzZXE6IDAsCiAgICAgICAgICAgIHN0YW1wOiAwLAogICAgICAgICAgICBmcmFtZV9pZDogJycKICAgICAgICAgIH0sCiAgICAgICAgICBhY3Rpb246IGFjdGlvbi52YWx1ZSwKICAgICAgICAgIHN0YXR1czogQUNUSU9OX1NUQVRVUy5BQ1RJVkUsCiAgICAgICAgICBhY3Rpb25faWQ6IGFjdGlvbklkLAogICAgICAgICAgdHlwZTogYWN0aW9uLnR5cGUsCiAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShhY3Rpb24uZGF0YSkKICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0pOwoKICAgIGlmICghKHJvcyBpbnN0YW5jZW9mIFJPU0xJQi5Sb3MpKSByZXR1cm47CgogICAgX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9hZ3ZBY3Rpb25Ub3BpYywgbmV3IFJPU0xJQi5Ub3BpYyh7CiAgICAgIHJvczogcm9zLAogICAgICBuYW1lOiAnL2Fndl9hY3Rpb24nLAogICAgICBtZXNzYWdlVHlwZTogJ2Fndl9kZWZpbmUvYWd2X2FjdGlvbicKICAgIH0pKTsKCiAgICBfY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX2FndkFjdGlvblN0YXR1c1RvcGljLCBuZXcgUk9TTElCLlRvcGljKHsKICAgICAgcm9zOiByb3MsCiAgICAgIG5hbWU6ICcvYWN0aW9uX3N0YXR1cycsCiAgICAgIG1lc3NhZ2VUeXBlOiAnYWd2X2RlZmluZS9hZ3ZfYWN0aW9uJwogICAgfSkpOwoKICAgIF9jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfYWd2QWN0aW9uU3RhdHVzVG9waWMpLnN1YnNjcmliZShfY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2FjdGlvblN0YXR1c1RvcGljUmVjZWl2ZWQpKTsKICB9CgogIF9jcmVhdGVDbGFzcyhBZ3ZyQWN0aW9uLCBbewogICAga2V5OiAicHVzaEFjdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3B1c2hBY3Rpb24gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoYWN0aW9uKSB7CiAgICAgICAgdmFyIHdhaXRSZXN1bHQsCiAgICAgICAgICAgIGFjdGlvbklkLAogICAgICAgICAgICBjb3VudCwKICAgICAgICAgICAgX2FyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgd2FpdFJlc3VsdCA9IF9hcmdzLmxlbmd0aCA+IDEgJiYgX2FyZ3NbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzFdIDogZmFsc2U7CgogICAgICAgICAgICAgICAgaWYgKCEoX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9hZ3ZBY3Rpb25Ub3BpYykgPT0gbnVsbCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIEFDVElPTl9TVEFUVVMuUkVKRUNURUQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBhY3Rpb25JZCA9ICJhY3Rpb24tIi5jb25jYXQodXVpZC52NCgpKTsKCiAgICAgICAgICAgICAgICBpZiAod2FpdFJlc3VsdCA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICBfY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2FjdGlvbnMpW2FjdGlvbklkXSA9IEFDVElPTl9TVEFUVVMuUEVORElORzsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2FndkFjdGlvblRvcGljKS5wdWJsaXNoKG5ldyBST1NMSUIuTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgIGhlYWRlcjogewogICAgICAgICAgICAgICAgICAgIHNlcTogMCwKICAgICAgICAgICAgICAgICAgICBzdGFtcDogMCwKICAgICAgICAgICAgICAgICAgICBmcmFtZV9pZDogJycKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24udmFsdWUsCiAgICAgICAgICAgICAgICAgIHN0YXR1czogQUNUSU9OX1NUQVRVUy5BQ1RJVkUsCiAgICAgICAgICAgICAgICAgIGFjdGlvbl9pZDogYWN0aW9uSWQsCiAgICAgICAgICAgICAgICAgIHR5cGU6IGFjdGlvbi50eXBlLAogICAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShhY3Rpb24uZGF0YSkKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICBpZiAoISh3YWl0UmVzdWx0ID09PSB0cnVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvdW50ID0gMDsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgaWYgKCEoX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9hY3Rpb25zKVthY3Rpb25JZF0gPT09IEFDVElPTl9TVEFUVVMuUEVORElORyAmJiBjb3VudCA8IDMwMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb3VudCsrOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgcmV0dXJuIHNsZWVwKDUwMCk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgaWYgKCEoX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9hY3Rpb25zKVthY3Rpb25JZF0gPT09IEFDVElPTl9TVEFUVVMuQUNUSVZFKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgaWYgKCEoX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9hY3Rpb25zKVthY3Rpb25JZF0gPT09IEFDVElPTl9TVEFUVVMuQUNUSVZFKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxODsKICAgICAgICAgICAgICAgIHJldHVybiBzbGVlcCg1MDApOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBfY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2FjdGlvbnMpW2FjdGlvbklkXSk7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcHVzaEFjdGlvbihfeCkgewogICAgICAgIHJldHVybiBfcHVzaEFjdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gcHVzaEFjdGlvbjsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImRpc3Bvc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAgIF9jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfYWd2QWN0aW9uVG9waWMsIG51bGwpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEFndnJBY3Rpb247Cn0oKTsKCmV4cG9ydCB7IEFndnJBY3Rpb24gYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["/home/robotics/AnhNV/agv-dasboard/src/services/agvr/agvr-action.js"],"names":["ROSLIB","ACTION_STATUS","uuid","sleep","ms","Promise","resolve","setTimeout","AgvrAction","ros","message","action_id","status","action","actionId","v4","publish","Message","header","seq","stamp","frame_id","value","ACTIVE","type","data","JSON","stringify","Ros","Topic","name","messageType","subscribe","waitResult","REJECTED","PENDING","count"],"mappings":"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","sourcesContent":["import ROSLIB from \"roslib\";\nimport * as ACTION_STATUS from './agv-action-status';\nimport { uuid } from \"vue-uuid\";\n\nfunction sleep(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport default class AgvrAction {\n  #agvActionTopic = null;\n  #agvActionStatusTopic = null;\n  #actions = {};\n\n  constructor(ros) {\n    if (!(ros instanceof ROSLIB.Ros)) return;\n\n    this.#agvActionTopic = new ROSLIB.Topic({\n      ros: ros,\n      name: '/agv_action',\n      messageType: 'agv_define/agv_action',\n    });\n\n    this.#agvActionStatusTopic = new ROSLIB.Topic({\n      ros: ros,\n      name: '/action_status',\n      messageType: 'agv_define/agv_action',\n    });\n\n    this.#agvActionStatusTopic.subscribe(this.#actionStatusTopicReceived);\n  }\n\n  #actionStatusTopicReceived = (message) => {\n    this.#actions[message.action_id] = message.status;\n  }\n  \n\n  async pushAction(action, waitResult = false) {\n    if (this.#agvActionTopic == null) return ACTION_STATUS.REJECTED;\n\n    let actionId = `action-${uuid.v4()}`;\n    if(waitResult === true) {\n      this.#actions[actionId] = ACTION_STATUS.PENDING;\n    }\n\n    this.#agvActionTopic.publish(new ROSLIB.Message({\n      header: { seq: 0, stamp: 0, frame_id: '', },\n      action: action.value,\n      status: ACTION_STATUS.ACTIVE,\n      action_id: actionId,\n      type: action.type,\n      data: JSON.stringify(action.data),\n    }))\n\n    if(waitResult === true) {\n      let count = 0;\n      while(this.#actions[actionId] === ACTION_STATUS.PENDING && count < 300) {\n        count++;\n        await sleep(500);\n      }\n\n      if(this.#actions[actionId] === ACTION_STATUS.ACTIVE) {\n        while(this.#actions[actionId] === ACTION_STATUS.ACTIVE) {\n          await sleep(500);\n        }\n      }\n      return this.#actions[actionId]; \n    }\n  }\n\n  #publishAction = (action) => {\n    if (this.#agvActionTopic == null) return;\n\n    let actionId = `action-${uuid.v4()}`;\n    this.#agvActionTopic.publish(new ROSLIB.Message({\n      header: { seq: 0, stamp: 0, frame_id: '', },\n      action: action.value,\n      status: ACTION_STATUS.ACTIVE,\n      action_id: actionId,\n      type: action.type,\n      data: JSON.stringify(action.data),\n    }))\n  }\n\n  dispose() {\n    this.#agvActionTopic = null;\n  }\n}"]}]}