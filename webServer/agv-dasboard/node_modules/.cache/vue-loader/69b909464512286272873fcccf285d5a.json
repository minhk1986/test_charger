{"remainingRequest":"/home/robotics/AnhNV/agv-dasboard/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/robotics/AnhNV/agv-dasboard/src/components/AgvNavigation/AgvInitializeNavigation/AgvInitializeNavigation.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/robotics/AnhNV/agv-dasboard/src/components/AgvNavigation/AgvInitializeNavigation/AgvInitializeNavigation.vue","mtime":1609149479952},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/cache-loader/dist/cjs.js","mtime":1602053610278},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/thread-loader/dist/cjs.js","mtime":1602053610301},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/babel-loader/lib/index.js","mtime":1602053610019},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/cache-loader/dist/cjs.js","mtime":1602053610278},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/vue-loader/lib/index.js","mtime":1602053621134}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGNyZWF0ZU5hbWVzcGFjZWRIZWxwZXJzLCBtYXBTdGF0ZSB9IGZyb20gInZ1ZXgiOwppbXBvcnQgeyB1dWlkIH0gZnJvbSAidnVlLXV1aWQiOwppbXBvcnQgQWd2ck1hcEltYWdlIGZyb20gIkAvY29tcG9uZW50cy9BZ3ZyTWFwSW1hZ2UiOwppbXBvcnQgQWd2clJvYm90IGZyb20gIkAvY29tcG9uZW50cy9BZ3ZyUm9ib3QiOwppbXBvcnQgQWd2clJvYm90RGlyZWN0aW9uIGZyb20gIkAvY29tcG9uZW50cy9BZ3ZyUm9ib3REaXJlY3Rpb24iOwppbXBvcnQgewogIEFndnJSb2JvdEluaXRQb3NlTWVudUNvbnRleHQsCn0gZnJvbSAiQC9jb21wb25lbnRzL01lbnVDb250ZXh0cyI7Cgpjb25zdCB7IG1hcFN0YXRlOiBuYXZpZ2F0aW9uTWFwU3RhdGUgfSA9IGNyZWF0ZU5hbWVzcGFjZWRIZWxwZXJzKCJuYXZpZ2F0aW9uIik7CmNvbnN0IHsgbWFwU3RhdGU6IGFndk1hcHNNYXBTdGF0ZSB9ID0gY3JlYXRlTmFtZXNwYWNlZEhlbHBlcnMoImFndk1hcHMiKTsKY29uc3QgeyBtYXBBY3Rpb25zOiBhZ3ZzTWFwQWN0aW9ucyB9ID0gY3JlYXRlTmFtZXNwYWNlZEhlbHBlcnMoImFndnMiKTsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQWd2SW5pdGlhbGl6ZU5hdmlnYXRpb24iLAogIGNvbXBvbmVudHM6IHsKICAgIEFndnJSb2JvdCwKICAgIEFndnJSb2JvdERpcmVjdGlvbiwKICAgIEFndnJNYXBJbWFnZSwKICAgIEFndnJSb2JvdEluaXRQb3NlTWVudUNvbnRleHQsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZ3JhcGhpY0lEOiBgYWd2LW1hcC16b29tcGFuLWluaXRpYWxpemUtcG9zZS0ke3V1aWQudjQoKX1gLAogICAgICBwYW5ab29tOiBudWxsLAogICAgICB0b3VjaENsaWVudFg6IC0xLAogICAgICB0b3VjaENsaWVudFk6IC0xLAogICAgICBzZ3ZXaWR0aDogMCwKICAgICAgc2d2SGVpZ2h0OiAwLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5uYXZpZ2F0aW9uTWFwU3RhdGUoewogICAgICBuYXZpZ2F0aW9uTWFwSWQ6IChzdGF0ZSkgPT4gc3RhdGUubWFwSWQsCiAgICAgIG5hdmlnYXRpb25BZ3ZJZDogKHN0YXRlKSA9PiBzdGF0ZS5hZ3ZJZCwKICAgIH0pLAogICAgLi4uYWd2TWFwc01hcFN0YXRlKHsKICAgICAgYWd2TWFwSW1hZ2Uoc3RhdGUpIHsKICAgICAgICBsZXQgbWFwID0gc3RhdGUuZmluZCgobSkgPT4gbS5pZCA9PT0gdGhpcy5uYXZpZ2F0aW9uTWFwSWQpOwogICAgICAgIHJldHVybiBtYXAgIT0gbnVsbCA/IG1hcC53ZWJNYXAuSW1hZ2UgOiBudWxsOwogICAgICB9LAogICAgICBhZ3ZNYXBSZXNvbHV0aW9uKHN0YXRlKSB7CiAgICAgICAgbGV0IG1hcCA9IHN0YXRlLmZpbmQoKG0pID0+IG0uaWQgPT09IHRoaXMubmF2aWdhdGlvbk1hcElkKTsKICAgICAgICByZXR1cm4gbWFwICE9IG51bGwgPyBtYXAucm9zTWFwLmluZm8ucmVzb2x1dGlvbiA6IDE7CiAgICAgIH0sCiAgICAgIGFndk1hcFNjYWxlKHN0YXRlKSB7CiAgICAgICAgbGV0IG1hcCA9IHN0YXRlLmZpbmQoKG0pID0+IG0uaWQgPT09IHRoaXMubmF2aWdhdGlvbk1hcElkKTsKICAgICAgICByZXR1cm4gbWFwICE9IG51bGwgPyBtYXAud2ViTWFwLnNjYWxlIDogMTsKICAgICAgfSwKICAgIH0pLAogICAgLi4ubWFwU3RhdGUoewogICAgICBuYXZpZ2F0aW9uV2ViTWFwOiAoc3RhdGUpID0+CiAgICAgICAgc3RhdGUucm9zLm1hcHNbc3RhdGUubmF2aWdhdGlvbi5zZWxlY3RlZE1hcElkXS53ZWJNYXAsCiAgICAgIHZpZXdXaWR0aDogKHN0YXRlKSA9PiBzdGF0ZS5uYXZpZ2F0aW9uLnZpZXdXaWR0aCwKICAgICAgdmlld0hlaWdodDogKHN0YXRlKSA9PiBzdGF0ZS5uYXZpZ2F0aW9uLnZpZXdIZWlnaHQsCiAgICAgIG5hdmlnYXRpb25TZWxlY3Rpb25UeXBlOiAoc3RhdGUpID0+IHN0YXRlLm5hdmlnYXRpb24uc2VsZWN0aW9uVHlwZSwKICAgICAgbmF2aWdhdGlvbk1hcFBhblpvb21FbmFibGU6IChzdGF0ZSkgPT4gc3RhdGUubmF2aWdhdGlvbi5tYXBQYW5ab29tRW5hYmxlLAogICAgfSksCiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5hZ3ZzTWFwQWN0aW9ucyh7CiAgICAgIG1vdmVBZ3ZQb3NpdGlvbjogIm1vdmVBZ3ZQb3NpdGlvbiIsCiAgICAgIGNoYW5nZUFndkRpcmVjdGlvbjogImNoYW5nZUFndkRpcmVjdGlvbiIsCiAgICB9KSwKICAgIG9uSW5pdFpvb21QYW4oZSkgewogICAgICB0aGlzLnBhblpvb20gPSBlOwogICAgfSwKICAgIG9uTW91c2VNb3ZlKGUpIHsKICAgICAgbGV0IHRyYW5zZm9ybSA9IHRoaXMucGFuWm9vbS5nZXRUcmFuc2Zvcm0oKTsKICAgICAgc3dpdGNoICh0aGlzLm5hdmlnYXRpb25TZWxlY3Rpb25UeXBlKSB7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgdGhpcy5tb3ZlQWd2UG9zaXRpb24oewogICAgICAgICAgICBtb3ZlbWVudFg6IGUubW92ZW1lbnRYIC8gdHJhbnNmb3JtLnNjYWxlLAogICAgICAgICAgICBtb3ZlbWVudFk6IGUubW92ZW1lbnRZIC8gdHJhbnNmb3JtLnNjYWxlLAogICAgICAgICAgICBhZ3ZJZDogdGhpcy5uYXZpZ2F0aW9uQWd2SWQsCiAgICAgICAgICB9KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNDoKICAgICAgICAgIHRoaXMuY2hhbmdlQWd2RGlyZWN0aW9uKHsKICAgICAgICAgICAgbW91c2U6IHsKICAgICAgICAgICAgICB4OiAoZS5sYXllclggLSB0cmFuc2Zvcm0ueCkgLyB0cmFuc2Zvcm0uc2NhbGUsCiAgICAgICAgICAgICAgeTogKGUubGF5ZXJZIC0gdHJhbnNmb3JtLnkpIC8gdHJhbnNmb3JtLnNjYWxlLAogICAgICAgICAgICB9LAogICAgICAgICAgICBhZ3ZJZDogdGhpcy5uYXZpZ2F0aW9uQWd2SWQsCiAgICAgICAgICB9KTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9LAogICAgb25Ub3VjaFN0YXJ0KGUpIHsKICAgICAgbGV0IHRvdWNoID0gZS5jaGFuZ2VkVG91Y2hlc1swXTsKICAgICAgdGhpcy50b3VjaENsaWVudFggPSB0b3VjaC5jbGllbnRYOwogICAgICB0aGlzLnRvdWNoQ2xpZW50WSA9IHRvdWNoLmNsaWVudFk7CiAgICB9LAogICAgb25Ub3VjaEVuZCgpIHsKICAgICAgdGhpcy50b3VjaENsaWVudFggPSAtMTsKICAgICAgdGhpcy50b3VjaENsaWVudFkgPSAtMTsKICAgIH0sCiAgICBvblRvdWNoTW92ZShlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgaWYgKHRoaXMudG91Y2hDbGllbnRYID4gMCAmJiB0aGlzLnRvdWNoQ2xpZW50WSA+IDApIHsKICAgICAgICBsZXQgdG91Y2ggPSBlLmNoYW5nZWRUb3VjaGVzWzBdOwogICAgICAgIHRoaXMub25Nb3VzZU1vdmUoewogICAgICAgICAgbW92ZW1lbnRYOiB0b3VjaC5jbGllbnRYIC0gdGhpcy50b3VjaENsaWVudFgsCiAgICAgICAgICBtb3ZlbWVudFk6IHRvdWNoLmNsaWVudFkgLSB0aGlzLnRvdWNoQ2xpZW50WSwKICAgICAgICAgIGxheWVyWDogdG91Y2guY2xpZW50WCwKICAgICAgICAgIGxheWVyWTogdG91Y2guY2xpZW50WSwKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy50b3VjaENsaWVudFggPSB0b3VjaC5jbGllbnRYOwogICAgICAgIHRoaXMudG91Y2hDbGllbnRZID0gdG91Y2guY2xpZW50WTsKICAgICAgfQogICAgfSwKICAgIG9uQ29udGV4dE1lbnUoZSkgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9LAogICAgb25QYW5ab29tRG91YmxlQ2xpY2soKSB7fSwKICB9LAogIHdhdGNoOiB7CiAgICBuYXZpZ2F0aW9uTWFwUGFuWm9vbUVuYWJsZSh2YWwpIHsKICAgICAgaWYgKHZhbCkgewogICAgICAgIGlmICh0aGlzLnBhblpvb20uaXNQYXVzZWQoKSkgewogICAgICAgICAgdGhpcy5wYW5ab29tLnJlc3VtZSgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIXRoaXMucGFuWm9vbS5pc1BhdXNlZCgpKSB7CiAgICAgICAgICB0aGlzLnBhblpvb20ucGF1c2UoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhZ3ZNYXBJbWFnZSh2YWwpIHsKICAgICAgaWYgKHZhbCA9PSBudWxsKSByZXR1cm47CiAgICAgIHRoaXMuc2d2V2lkdGggPSB2YWwud2lkdGg7CiAgICAgIHRoaXMuc2d2SGVpZ2h0ID0gdmFsLmhlaWdodDsKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgaWYgKHRoaXMuYWd2TWFwSW1hZ2UgIT0gbnVsbCkgewogICAgICB0aGlzLnNndldpZHRoID0gdGhpcy5hZ3ZNYXBJbWFnZS53aWR0aDsKICAgICAgdGhpcy5zZ3ZIZWlnaHQgPSB0aGlzLmFndk1hcEltYWdlLmhlaWdodDsKICAgIH0KICB9LAp9Owo="},{"version":3,"sources":["AgvInitializeNavigation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AgvInitializeNavigation.vue","sourceRoot":"src/components/AgvNavigation/AgvInitializeNavigation","sourcesContent":["<template>\n  <v-container fluid class=\"pa-0 agv-navigation\">\n    <panZoom\n      class=\"panzoom-map-initialize-pose-viewer\"\n      :selector=\"`#${graphicID}`\"\n      :options=\"{\n        minZoom: 0.1,\n        maxZoom: 5,\n        zoomSpeed: 0.05,\n        zoomDoubleClickSpeed: 1,\n        onDoubleClick: onPanZoomDoubleClick,\n        autocenter: true,\n      }\"\n      @init=\"onInitZoomPan\"\n    >\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        class=\"map-viewer-svg\"\n        :height=\"(agvMapImage == null || viewHeight > agvMapImage.height) ? viewHeight : agvMapImage.height\"\n        :width=\"(agvMapImage == null || viewWidth > agvMapImage.width) ? viewWidth : agvMapImage.width\"\n        :id=\"graphicID\"\n        @mousemove=\"onMouseMove\"\n        @contextmenu=\"onContextMenu\"\n      >\n        <g\n          @touchstart=\"onTouchStart\"\n          @touchmove=\"onTouchMove\"\n          @touchend=\"onTouchEnd\"\n        >\n          <AgvrMapImage :mapId=\"navigationMapId\" />\n          <AgvrRobotDirection :agvId=\"navigationAgvId\" />\n          <AgvrRobot\n            :selectable=\"true\"\n            :agvId=\"navigationAgvId\"\n            :agvMapResolution=\"agvMapResolution\"\n            :agvMapScale=\"agvMapScale\"\n          />\n        </g>\n      </svg>\n    </panZoom>\n    <AgvrRobotInitPoseMenuContext />\n  </v-container>\n</template>\n<script>\nimport { createNamespacedHelpers, mapState } from \"vuex\";\nimport { uuid } from \"vue-uuid\";\nimport AgvrMapImage from \"@/components/AgvrMapImage\";\nimport AgvrRobot from \"@/components/AgvrRobot\";\nimport AgvrRobotDirection from \"@/components/AgvrRobotDirection\";\nimport {\n  AgvrRobotInitPoseMenuContext,\n} from \"@/components/MenuContexts\";\n\nconst { mapState: navigationMapState } = createNamespacedHelpers(\"navigation\");\nconst { mapState: agvMapsMapState } = createNamespacedHelpers(\"agvMaps\");\nconst { mapActions: agvsMapActions } = createNamespacedHelpers(\"agvs\");\n\nexport default {\n  name: \"AgvInitializeNavigation\",\n  components: {\n    AgvrRobot,\n    AgvrRobotDirection,\n    AgvrMapImage,\n    AgvrRobotInitPoseMenuContext,\n  },\n  data() {\n    return {\n      graphicID: `agv-map-zoompan-initialize-pose-${uuid.v4()}`,\n      panZoom: null,\n      touchClientX: -1,\n      touchClientY: -1,\n      sgvWidth: 0,\n      sgvHeight: 0,\n    };\n  },\n  computed: {\n    ...navigationMapState({\n      navigationMapId: (state) => state.mapId,\n      navigationAgvId: (state) => state.agvId,\n    }),\n    ...agvMapsMapState({\n      agvMapImage(state) {\n        let map = state.find((m) => m.id === this.navigationMapId);\n        return map != null ? map.webMap.Image : null;\n      },\n      agvMapResolution(state) {\n        let map = state.find((m) => m.id === this.navigationMapId);\n        return map != null ? map.rosMap.info.resolution : 1;\n      },\n      agvMapScale(state) {\n        let map = state.find((m) => m.id === this.navigationMapId);\n        return map != null ? map.webMap.scale : 1;\n      },\n    }),\n    ...mapState({\n      navigationWebMap: (state) =>\n        state.ros.maps[state.navigation.selectedMapId].webMap,\n      viewWidth: (state) => state.navigation.viewWidth,\n      viewHeight: (state) => state.navigation.viewHeight,\n      navigationSelectionType: (state) => state.navigation.selectionType,\n      navigationMapPanZoomEnable: (state) => state.navigation.mapPanZoomEnable,\n    }),\n  },\n  methods: {\n    ...agvsMapActions({\n      moveAgvPosition: \"moveAgvPosition\",\n      changeAgvDirection: \"changeAgvDirection\",\n    }),\n    onInitZoomPan(e) {\n      this.panZoom = e;\n    },\n    onMouseMove(e) {\n      let transform = this.panZoom.getTransform();\n      switch (this.navigationSelectionType) {\n        case 3:\n          this.moveAgvPosition({\n            movementX: e.movementX / transform.scale,\n            movementY: e.movementY / transform.scale,\n            agvId: this.navigationAgvId,\n          });\n          break;\n        case 4:\n          this.changeAgvDirection({\n            mouse: {\n              x: (e.layerX - transform.x) / transform.scale,\n              y: (e.layerY - transform.y) / transform.scale,\n            },\n            agvId: this.navigationAgvId,\n          });\n          break;\n      }\n    },\n    onTouchStart(e) {\n      let touch = e.changedTouches[0];\n      this.touchClientX = touch.clientX;\n      this.touchClientY = touch.clientY;\n    },\n    onTouchEnd() {\n      this.touchClientX = -1;\n      this.touchClientY = -1;\n    },\n    onTouchMove(e) {\n      e.preventDefault();\n      if (this.touchClientX > 0 && this.touchClientY > 0) {\n        let touch = e.changedTouches[0];\n        this.onMouseMove({\n          movementX: touch.clientX - this.touchClientX,\n          movementY: touch.clientY - this.touchClientY,\n          layerX: touch.clientX,\n          layerY: touch.clientY,\n        });\n\n        this.touchClientX = touch.clientX;\n        this.touchClientY = touch.clientY;\n      }\n    },\n    onContextMenu(e) {\n      e.preventDefault();\n      e.stopPropagation();\n    },\n    onPanZoomDoubleClick() {},\n  },\n  watch: {\n    navigationMapPanZoomEnable(val) {\n      if (val) {\n        if (this.panZoom.isPaused()) {\n          this.panZoom.resume();\n        }\n      } else {\n        if (!this.panZoom.isPaused()) {\n          this.panZoom.pause();\n        }\n      }\n    },\n    agvMapImage(val) {\n      if (val == null) return;\n      this.sgvWidth = val.width;\n      this.sgvHeight = val.height;\n    },\n  },\n  mounted() {\n    if (this.agvMapImage != null) {\n      this.sgvWidth = this.agvMapImage.width;\n      this.sgvHeight = this.agvMapImage.height;\n    }\n  },\n};\n</script>\n\n<style scoped>\n.panzoom-map-initialize-pose-viewer {\n  border: none;\n  width: 100%;\n  height: 100%;\n}\n</style>"]}]}