{"remainingRequest":"/home/robotics/AnhNV/agv-dasboard/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/robotics/AnhNV/agv-dasboard/src/components/AgvrRobot/AgvrRobot.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/robotics/AnhNV/agv-dasboard/src/components/AgvrRobot/AgvrRobot.vue","mtime":1609222549013},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/cache-loader/dist/cjs.js","mtime":1602053610278},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/thread-loader/dist/cjs.js","mtime":1602053610301},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/babel-loader/lib/index.js","mtime":1602053610019},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/cache-loader/dist/cjs.js","mtime":1602053610278},{"path":"/home/robotics/AnhNV/agv-dasboard/node_modules/vue-loader/lib/index.js","mtime":1602053621134}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGNyZWF0ZU5hbWVzcGFjZWRIZWxwZXJzIH0gZnJvbSAidnVleCI7Cgpjb25zdCB7CiAgbWFwU3RhdGU6IG5hdmlnYXRpb25NYXBTdGF0ZSwKICBtYXBBY3Rpb25zOiBuYXZpZ2F0aW9uTWFwQWN0aW9uLAp9ID0gY3JlYXRlTmFtZXNwYWNlZEhlbHBlcnMoIm5hdmlnYXRpb24iKTsKCmNvbnN0IHsgbWFwU3RhdGU6IGFndnNNYXBTdGF0ZSB9ID0gY3JlYXRlTmFtZXNwYWNlZEhlbHBlcnMoImFndnMiKTsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQWd2clJvYm90IiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGF0aERhdGE6ICIiLAogICAgICB0aW1lb3V0Q29udGV4dE1lbnU6IG51bGwsCiAgICAgIGFndldpZHRoOiAwLAogICAgICBhZ3ZIZWlnaHQ6IDAsCiAgICB9OwogIH0sCiAgcHJvcHM6IHsKICAgIHNlbGVjdGFibGU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICB9LAogICAgYWd2SWQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAiIiwKICAgIH0sCiAgICBhZ3ZNYXBSZXNvbHV0aW9uOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMSwKICAgIH0sCiAgICBhZ3ZNYXBTY2FsZTogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDEsCiAgICB9LAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLmFndnNNYXBTdGF0ZSh7CiAgICAgIGFndldlYlNpemUoc3RhdGUpIHsKICAgICAgICByZXR1cm4gc3RhdGUuZmluZCgoYSkgPT4gYS5pZCA9PT0gdGhpcy5hZ3ZJZCkuc2l6ZTsKICAgICAgfSwKICAgICAgYWd2V2ViUG9zZShzdGF0ZSkgewogICAgICAgIGxldCBhZ3YgPSBzdGF0ZS5maW5kKChhKSA9PiBhLmlkID09PSB0aGlzLmFndklkKTsKICAgICAgICByZXR1cm4gYWd2ICE9IG51bGwKICAgICAgICAgID8gYWd2LndlYlBvc2UKICAgICAgICAgIDogewogICAgICAgICAgICAgIHBvc2l0aW9uOiB7IHg6IDAsIHk6IDAsIHo6IDAgfSwKICAgICAgICAgICAgICBvcmllbnRhdGlvbjogeyB4OiAwLCB5OiAwLCB6OiAwIH0sCiAgICAgICAgICAgIH07CiAgICAgIH0sCiAgICAgIGFndlJ1bm5pbmdTdGF0ZShzdGF0ZSkgewogICAgICAgIGxldCBhZ3YgPSBzdGF0ZS5maW5kKChhKSA9PiBhLmlkID09PSB0aGlzLmFndklkKTsKICAgICAgICByZXR1cm4gYWd2Py5pc1J1bm5naW5nID8/IGZhbHNlID8gInZpc2libGUiIDogImhpZGRlbiI7CiAgICAgIH0sCiAgICB9KSwKICAgIC4uLm5hdmlnYXRpb25NYXBTdGF0ZSh7CiAgICAgIGlzQ29udGV4dE1lbnVTaG93OiAoc3RhdGUpID0+CiAgICAgICAgc3RhdGUudGFza01lbnVDb250ZXh0LmlzU2hvdyB8fAogICAgICAgIHN0YXRlLmFndk1lbnVDb250ZXh0LmlzU2hvdyB8fAogICAgICAgIHN0YXRlLmFndkluaXRQb3NlTWVudUNvbnRleHQuaXNTaG93LAogICAgfSksCiAgICB0cmFuc2Zvcm1EYXRhKCkgewogICAgICByZXR1cm4gYHJvdGF0ZSgke01hdGguZmxvb3IoCiAgICAgICAgOTAgLSB0aGlzLmFndldlYlBvc2Uub3JpZW50YXRpb24uegogICAgICApfSwke01hdGguZmxvb3IodGhpcy5hZ3ZXZWJQb3NlLnBvc2l0aW9uLngpfSwke01hdGguZmxvb3IoCiAgICAgICAgdGhpcy5hZ3ZXZWJQb3NlLnBvc2l0aW9uLnkKICAgICAgKX0pIHRyYW5zbGF0ZSgke3RoaXMuYWd2V2ViUG9zZS5wb3NpdGlvbi54IC0gdGhpcy5hZ3ZXaWR0aCAvIDJ9LCAkewogICAgICAgIHRoaXMuYWd2V2ViUG9zZS5wb3NpdGlvbi55IC0gdGhpcy5hZ3ZIZWlnaHQgLyAyCiAgICAgIH0pYDsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5uYXZpZ2F0aW9uTWFwQWN0aW9uKHsKICAgICAgbmF2aWdhdGlvblNob3dBZ3ZNZW51Q29udGV4dDogInNob3dBZ3ZNZW51Q29udGV4dCIsCiAgICAgIG5hdmlnYXRpb25TaG93QWd2SW5pdFBvc2VNZW51Q29udGV4dDogInNob3dBZ3ZJbml0UG9zZU1lbnVDb250ZXh0IiwKICAgICAgbmF2aWdhdGlvbkRpc2FibGVNYXBQYW5ab29tOiAiZGlzYWJsZU1hcFBhblpvb20iLAogICAgICBuYXZpZ2F0aW9uU2VsZWN0ZWRSb2JvdDogInNlbGVjdGVkUm9ib3QiLAogICAgfSksCiAgICBvbkNvbnRleHRNZW51KGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgaWYgKHRoaXMuc2VsZWN0YWJsZSkgewogICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU2hvd0FndkluaXRQb3NlTWVudUNvbnRleHQoewogICAgICAgICAgICB4OiBlLmNsaWVudFgsCiAgICAgICAgICAgIHk6IGUuY2xpZW50WSwKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLm5hdmlnYXRpb25TaG93QWd2TWVudUNvbnRleHQoewogICAgICAgICAgICB4OiBlLmNsaWVudFgsCiAgICAgICAgICAgIHk6IGUuY2xpZW50WSwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgc2VsZWN0ZWRSb2JvdCgpIHsKICAgICAgaWYgKHRoaXMuaXNDb250ZXh0TWVudVNob3cpIHJldHVybjsKICAgICAgdGhpcy5uYXZpZ2F0aW9uRGlzYWJsZU1hcFBhblpvb20oKTsKICAgICAgaWYgKHRoaXMuc2VsZWN0YWJsZSkgewogICAgICAgIHRoaXMubmF2aWdhdGlvblNlbGVjdGVkUm9ib3QoKTsKICAgICAgfQogICAgfSwKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmFndldpZHRoID0KICAgICAgKHRoaXMuYWd2V2ViU2l6ZS53aWR0aCAqIHRoaXMuYWd2TWFwU2NhbGUpIC8gdGhpcy5hZ3ZNYXBSZXNvbHV0aW9uOwogICAgdGhpcy5hZ3ZIZWlnaHQgPQogICAgICAodGhpcy5hZ3ZXZWJTaXplLmhlaWdodCAqIHRoaXMuYWd2TWFwU2NhbGUpIC8gdGhpcy5hZ3ZNYXBSZXNvbHV0aW9uOwogIH0sCiAgd2F0Y2g6IHsKICAgIGFndldlYlNpemUodmFsKSB7CiAgICAgIHRoaXMuYWd2V2lkdGggPSAodmFsLndpZHRoICogdGhpcy5hZ3ZNYXBTY2FsZSkgLyB0aGlzLmFndk1hcFJlc29sdXRpb247CiAgICAgIHRoaXMuYWd2SGVpZ2h0ID0gKHZhbC5oZWlnaHQgKiB0aGlzLmFndk1hcFNjYWxlKSAvIHRoaXMuYWd2TWFwUmVzb2x1dGlvbjsKICAgIH0sCiAgICBhZ3ZNYXBSZXNvbHV0aW9uKHZhbCkgewogICAgICB0aGlzLmFndldpZHRoID0gKHRoaXMuYWd2V2ViU2l6ZS53aWR0aCAqIHRoaXMuYWd2TWFwU2NhbGUpIC8gdmFsOwogICAgICB0aGlzLmFndkhlaWdodCA9ICh0aGlzLmFndldlYlNpemUuaGVpZ2h0ICogdGhpcy5hZ3ZNYXBTY2FsZSkgLyB2YWw7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["AgvrRobot.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AgvrRobot.vue","sourceRoot":"src/components/AgvrRobot","sourcesContent":["<template>\n  <g\n    @contextmenu=\"onContextMenu\"\n    @mousedown=\"selectedRobot\"\n    @touchstart=\"selectedRobot\"\n    :transform=\"transformData\"\n  >\n    <!-- <defs>\n      <filter id=\"filter-boxshadow\" :x=\"0\" :y=\"0\" width=\"200%\" height=\"200%\">\n        <feOffset in=\"SourceGraphic\" dx=\"0\" dy=\"0\" />\n        <feGaussianBlur result=\"blurOut\" in=\"offOut\" stdDeviation=\"5\" />\n        <feBlend in=\"SourceGraphic\" in2=\"blurOut\" mode=\"normal\" />\n      </filter>\n    </defs> -->\n    <!-- <rect :x=\"-agvWidth/2\" :y=\"-agvHeight/2\" :width=\"agvWidth*2\" :height=\"agvHeight\" /> --> -->\n    <rect\n      :visibility=\"agvRunningState\"\n      style=\"fill: #ff9800\"\n      :x=\"-3\"\n      :y=\"-3\"\n      rx=\"5\"\n      ry=\"5\"\n      :width=\"agvWidth + 6\"\n      :height=\"agvHeight + 6\"\n    >\n      <animate\n        id=\"animate1\"\n        begin=\"0;animate2.end\"\n        attributeName=\"opacity\"\n        :from=\"0\"\n        :to=\"1\"\n        dur=\"0.4s\"\n      />\n      <animate\n        id=\"animate2\"\n        begin=\"animate1.end\"\n        attributeName=\"opacity\"\n        :from=\"1\"\n        :to=\"0\"\n        dur=\"0.6s\"\n      />\n    </rect>\n    <image\n      :height=\"agvHeight\"\n      :width=\"agvWidth\"\n      href=\"@/assets/images/agv.svg\"\n    />\n    <image\n      :x=\"agvWidth / 4\"\n      :y=\"agvHeight / 4\"\n      :height=\"agvHeight / 2\"\n      :width=\"agvWidth / 2\"\n      href=\"@/assets/images/logo-white.png\"\n    />\n  </g>\n</template>\n\n<script>\nimport { createNamespacedHelpers } from \"vuex\";\n\nconst {\n  mapState: navigationMapState,\n  mapActions: navigationMapAction,\n} = createNamespacedHelpers(\"navigation\");\n\nconst { mapState: agvsMapState } = createNamespacedHelpers(\"agvs\");\n\nexport default {\n  name: \"AgvrRobot\",\n  data() {\n    return {\n      pathData: \"\",\n      timeoutContextMenu: null,\n      agvWidth: 0,\n      agvHeight: 0,\n    };\n  },\n  props: {\n    selectable: {\n      type: Boolean,\n      default: false,\n    },\n    agvId: {\n      type: String,\n      default: \"\",\n    },\n    agvMapResolution: {\n      type: Number,\n      default: 1,\n    },\n    agvMapScale: {\n      type: Number,\n      default: 1,\n    },\n  },\n  computed: {\n    ...agvsMapState({\n      agvWebSize(state) {\n        return state.find((a) => a.id === this.agvId).size;\n      },\n      agvWebPose(state) {\n        let agv = state.find((a) => a.id === this.agvId);\n        return agv != null\n          ? agv.webPose\n          : {\n              position: { x: 0, y: 0, z: 0 },\n              orientation: { x: 0, y: 0, z: 0 },\n            };\n      },\n      agvRunningState(state) {\n        let agv = state.find((a) => a.id === this.agvId);\n        return agv?.isRunnging ?? false ? \"visible\" : \"hidden\";\n      },\n    }),\n    ...navigationMapState({\n      isContextMenuShow: (state) =>\n        state.taskMenuContext.isShow ||\n        state.agvMenuContext.isShow ||\n        state.agvInitPoseMenuContext.isShow,\n    }),\n    transformData() {\n      return `rotate(${Math.floor(\n        90 - this.agvWebPose.orientation.z\n      )},${Math.floor(this.agvWebPose.position.x)},${Math.floor(\n        this.agvWebPose.position.y\n      )}) translate(${this.agvWebPose.position.x - this.agvWidth / 2}, ${\n        this.agvWebPose.position.y - this.agvHeight / 2\n      })`;\n    },\n  },\n  methods: {\n    ...navigationMapAction({\n      navigationShowAgvMenuContext: \"showAgvMenuContext\",\n      navigationShowAgvInitPoseMenuContext: \"showAgvInitPoseMenuContext\",\n      navigationDisableMapPanZoom: \"disableMapPanZoom\",\n      navigationSelectedRobot: \"selectedRobot\",\n    }),\n    onContextMenu(e) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.$nextTick(() => {\n        if (this.selectable) {\n          this.navigationShowAgvInitPoseMenuContext({\n            x: e.clientX,\n            y: e.clientY,\n          });\n        } else {\n          this.navigationShowAgvMenuContext({\n            x: e.clientX,\n            y: e.clientY,\n          });\n        }\n      });\n    },\n    selectedRobot() {\n      if (this.isContextMenuShow) return;\n      this.navigationDisableMapPanZoom();\n      if (this.selectable) {\n        this.navigationSelectedRobot();\n      }\n    },\n  },\n  mounted() {\n    this.agvWidth =\n      (this.agvWebSize.width * this.agvMapScale) / this.agvMapResolution;\n    this.agvHeight =\n      (this.agvWebSize.height * this.agvMapScale) / this.agvMapResolution;\n  },\n  watch: {\n    agvWebSize(val) {\n      this.agvWidth = (val.width * this.agvMapScale) / this.agvMapResolution;\n      this.agvHeight = (val.height * this.agvMapScale) / this.agvMapResolution;\n    },\n    agvMapResolution(val) {\n      this.agvWidth = (this.agvWebSize.width * this.agvMapScale) / val;\n      this.agvHeight = (this.agvWebSize.height * this.agvMapScale) / val;\n    },\n  },\n};\n</script>\n"]}]}